---
title: <span style="color:#034a94"> **Software R**</span>
author: "Nivelatorio de Estadística"
output: html_document
css: style.css
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, comment = NA)
# colores
c0= "#b0394a"
c1= "#ad6395"
c2= "#a391c4"
c3= "#8acfe6"
c4= "#646420"
c5= "#db524f"
paleta4=c("#0d3b66", "#faf0ca", "#f4d35e", "#ee964d")
library(paqueteMOD)
library(tidyverse)
data("apartamentos") # 54 x 10 (precio, area,cons) 

```

</br></br>

Con el propósito de revisar los códigos en R relacionados con los procesos descritos en la unidad se tomará información de las dos primeras variables contenidas en la base `ventas` contenida en el `paqueteMOD` 

* **vendedor**  : id del vendedor 
* **ventas**     : valor de las ventas
* **clientes** :  número de clientes

### **Carga de los datos**

```{r, eval=FALSE}
library(paqueteMOD)
library(tidyverse)
data(ventas) 

```

</br></br>

### **Descripción de las variables**

```{r}
summarytools::descr(ventas[,2:3])
```

</br></br>


```{r}
library(patchwork)
p1 = ggplot(ventas, aes(x=clientes))+geom_boxplot()
p2 = ggplot(ventas, aes(x=ventas))+ geom_boxplot()
p3 = ggplot(ventas, aes(x=clientes))+geom_density()
p4 = ggplot(ventas, aes(x=ventas))+ geom_density()

(p1 + p2)/(p3 + p4)
```

</br></br>


### **Diagrama de dispersión**

En este diagrama se pretende visualizar la relación existente entre las variables, si se puede ajustar a una linea recta o si por el contrario se debe realizar una transformación.

Se pueden utilizar las funciones: 

* `plot(x,y)` 
* `gplot(data, aes(x,y))+ geom_point()` 


```{r}
library(ggplot2)
ggplot(ventas, aes(x=clientes, y=ventas))+
  geom_point()
```

</br></br>

### **Normalidad de las variables**

```{r}
shapiro.test(ventas$clientes)
shapiro.test(ventas$ventas)
```

</br></br>

### **Inferencia sobre  la correlación**

```{r}
cor.test(ventas$ventas, ventas$clientes)

```

</br></br>

### **Estimación del modelo por MCO**

Para la estimación del modelo requerimos las funciones:

* `modelo <- lm(formula, data, weights)` : estima el modelo MCO
* `summary(modelo)                     ` : visualiza el objeto  

```{r, message=FALSE, warning=FALSE}
modelo1=lm(ventas ~ clientes, ventas)
summary(modelo1)
```

</br></br>

#### **Forma funcional del modelo**
<pre>
Call:
lm(formula = ventas ~ clientes, data = ventas)
</pre>

#### **Resumen de los residuales**
<pre>
Residuals:
    Min      1Q  Median      3Q     Max 
-11.873  -2.861   0.255   3.511  10.595 
</pre>

#### **Estimación MCO de los coeficientes $\beta_{0}$ y $\beta_{1}$**
<pre>
Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  19.9800     4.3897   4.552 0.000544 ***
clientes      0.2606     0.0420   6.205 3.19e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre>

#### **Indicadores de significancia del modelo** 
<pre>
Residual standard error: 6.72 on 13 degrees of freedom
Multiple R-squared:  0.7476,	Adjusted R-squared:  0.7282 
F-statistic:  38.5 on 1 and 13 DF,  p-value: 3.193e-05
</pre>


</br></br>


### **Validación de los supuestos sobre los errores**


</br></br>



#### **Supuesto de normalidad de los errores**

```{r, message=FALSE, warning=FALSE}
e= modelo1$residuals
shapiro.test(e)
```

</br></br>


#### **Supuesto de independencia de errores**

```{r, message=FALSE, warning=FALSE}
library(lmtest)
dwtest(modelo1)
```

</br></br>


#### **Supuesto de varianza constante**

```{r, message=FALSE, warning=FALSE}
# Test de Homoscedasticidad
# Ho: la varianza de los erroes es constante
# Ho: V(u) = sigma2
gqtest(modelo1)
```

</br></br>

### **Supuesto de linealidad del modelo**

</br></br>


### **Representación gráfica del modelo**

```{r}
ggplot(ventas, aes(clientes, ventas)) +
            geom_point() + 
            geom_smooth(method = "lm",  level = 0.95, formula = y ~ x)
```


</br></br>

###

