<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Modelos Estadisticos para la toma de decisiones" />


<title> Software R</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Modelos de Regresión</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Correlación
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso201.html">Análisis de correlación</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Modelo
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso202.html">Modelo de regresión lineal simple</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Estimación
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso203.html">Método de mínimos cuadrados ordinarios</a>
    </li>
    <li>
      <a href="recurso208.html">Método de máxima verosimilitud</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Inferencia
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso204.html">Sobre los parámetros</a>
    </li>
    <li>
      <a href="recurso205.html">Respecto a la media de Y </a>
    </li>
    <li>
      <a href="recurso206.html">ANOVA - Análisis de la varianza </a>
    </li>
    <li>
      <a href="recurso209.html">Supuetos del modelo</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Software R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso207.html">Código R</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore"><span style="color:#034a94">
<strong>Software R</strong></span></h1>
<h4 class="author">Modelos Estadisticos para la toma de decisiones</h4>

</div>


<p></br></br></p>
<p>Con el propósito de revisar los códigos en R relacionados con los
procesos descritos en la unidad se tomará información de las dos
primeras variables contenidas en la base <code>ventas</code> contenida
en el <code>paqueteMOD</code></p>
<ul>
<li><strong>vendedor</strong> : id del vendedor</li>
<li><strong>ventas</strong> : valor de las ventas</li>
<li><strong>clientes</strong> : número de clientes</li>
</ul>
<p></br></br></p>
<div id="carga-de-los-datos" class="section level3">
<h3><span style="color:#034a94"><strong>Carga de los
datos</strong></span></h3>
<pre class="r"><code>library(paqueteMOD)
library(tidyverse)
data(ventas)</code></pre>
<p></br></br></p>
</div>
<div id="descripción-de-las-variables" class="section level3">
<h3><span style="color:#034a94"><strong>Descripción de las
variables</strong></span></h3>
<pre class="r"><code>summarytools::descr(ventas[,2:3])</code></pre>
<pre><code>Descriptive Statistics  

                    clientes   ventas
----------------- ---------- --------
             Mean      96.00    45.00
          Std.Dev      42.76    12.89
              Min      36.00    28.00
               Q1      72.00    31.00
           Median      84.00    43.00
               Q3     128.00    56.00
              Max     180.00    70.00
              MAD      53.37    17.79
              IQR      50.00    18.50
               CV       0.45     0.29
         Skewness       0.37     0.29
      SE.Skewness       0.58     0.58
         Kurtosis      -0.91    -1.16
          N.Valid      15.00    15.00
        Pct.Valid     100.00   100.00</code></pre>
<p></br></br></p>
<pre class="r"><code>library(ggplot2)
library(patchwork)
p1 = ggplot(ventas, aes(x=clientes))+geom_boxplot()
p2 = ggplot(ventas, aes(x=ventas))+ geom_boxplot()
p3 = ggplot(ventas, aes(x=clientes))+geom_density()
p4 = ggplot(ventas, aes(x=ventas))+ geom_density()

(p1 + p2)/(p3 + p4)</code></pre>
<p><img src="recurso207_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p></br></br></p>
</div>
<div id="diagrama-de-dispersión" class="section level3">
<h3><span style="color:#034a94"><strong>Diagrama de
dispersión</strong></span></h3>
<p>En este diagrama se pretende visualizar la relación existente entre
las variables, si se puede ajustar a una linea recta o si por el
contrario se debe realizar una transformación.</p>
<p>Se pueden utilizar las funciones:</p>
<ul>
<li><code>plot(x,y)</code></li>
<li><code>gplot(data, aes(x,y))+ geom_point()</code></li>
</ul>
<pre class="r"><code>library(ggplot2)
ggplot(ventas, aes(x=clientes, y=ventas))+
  geom_point()</code></pre>
<p><img src="recurso207_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p></br></br></p>
</div>
<div id="normalidad-de-las-variables" class="section level3">
<h3><span style="color:#034a94"><strong>Normalidad de las
variables</strong></span></h3>
<pre class="r"><code>shapiro.test(ventas$clientes)</code></pre>
<pre><code>
    Shapiro-Wilk normality test

data:  ventas$clientes
W = 0.95329, p-value = 0.5777</code></pre>
<pre class="r"><code>shapiro.test(ventas$ventas)</code></pre>
<pre><code>
    Shapiro-Wilk normality test

data:  ventas$ventas
W = 0.94876, p-value = 0.5052</code></pre>
<p></br></br></p>
</div>
<div id="inferencia-sobre-la-correlación" class="section level3">
<h3><span style="color:#034a94"><strong>Inferencia sobre la
correlación</strong></span></h3>
<pre class="r"><code>cor.test(ventas$ventas, ventas$clientes)</code></pre>
<pre><code>
    Pearson&#39;s product-moment correlation

data:  ventas$ventas and ventas$clientes
t = 6.2051, df = 13, p-value = 3.193e-05
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.6325270 0.9542427
sample estimates:
      cor 
0.8646318 </code></pre>
<p></br></br></p>
</div>
<div id="estimación-del-modelo-por-mco" class="section level3">
<h3><span style="color:#034a94"><strong>Estimación del modelo por
MCO</strong></span></h3>
<p>Para la estimación del modelo requerimos las funciones:</p>
<ul>
<li><code>modelo &lt;- lm(formula, data, weights)</code> : estima el
modelo MCO</li>
<li><code>summary(modelo)</code> : visualiza el objeto</li>
</ul>
<pre class="r"><code>modelo1=lm(ventas ~ clientes, ventas)
summary(modelo1)</code></pre>
<pre><code>
Call:
lm(formula = ventas ~ clientes, data = ventas)

Residuals:
    Min      1Q  Median      3Q     Max 
-11.873  -2.861   0.255   3.511  10.595 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  19.9800     4.3897   4.552 0.000544 ***
clientes      0.2606     0.0420   6.205 3.19e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 6.72 on 13 degrees of freedom
Multiple R-squared:  0.7476,    Adjusted R-squared:  0.7282 
F-statistic:  38.5 on 1 and 13 DF,  p-value: 3.193e-05</code></pre>
<p>La anterior salida se divide en cuatro partes: </br></br></p>
<div id="forma-funcional-del-modelo" class="section level4">
<h4><span style="color:#034a94"><strong>Forma funcional del
modelo</strong></span></h4>
<pre>

Call:
lm(formula = ventas ~ clientes, data = ventas)
</pre>
<p></br></p>
</div>
<div id="resumen-de-los-residuales" class="section level4">
<h4><span style="color:#034a94"><strong>Resumen de los
residuales</strong></span></h4>
<pre>
Residuals:
    Min      1Q  Median      3Q     Max 
-11.873  -2.861   0.255   3.511  10.595 
</pre>
<p></br></br></p>
</div>
<div id="estimación-mco-de-los-coeficientes-beta_0-y-beta_1"
class="section level4">
<h4><span style="color:#034a94"><strong>Estimación MCO de los
coeficientes <span class="math inline">\(\beta_{0}\)</span> y <span
class="math inline">\(\beta_{1}\)</span></strong></span></h4>
<pre>
Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  19.9800     4.3897   4.552 0.000544 ***
clientes      0.2606     0.0420   6.205 3.19e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre>
<p></br></br></p>
</div>
<div id="indicadores-de-significancia-del-modelo"
class="section level4">
<h4><span style="color:#034a94"><strong>Indicadores de significancia del
modelo</strong> </span></h4>
<pre>
Residual standard error: 6.72 on 13 degrees of freedom
Multiple R-squared:  0.7476,    Adjusted R-squared:  0.7282 
F-statistic:  38.5 on 1 and 13 DF,  p-value: 3.193e-05
</pre>
<p></br></br></p>
</div>
</div>
<div id="validación-de-los-supuestos-sobre-los-errores"
class="section level3">
<h3><span style="color:#034a94"><strong>Validación de los supuestos
sobre los errores</strong></span></h3>
<p></br></p>
<p>Inicialmente se revisar los gráficos generados con el objeto
<code>modelo1</code></p>
<pre class="r"><code>par(mfrow = c(2, 2))
plot(modelo1)</code></pre>
<p><img src="recurso207_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p></br></br></p>
<p>Ahora utilizando pruebas de hipótesis</p>
</div>
<div id="supuesto-de-normalidad-de-los-errores" class="section level3">
<h3><span style="color:#034a94"><strong>Supuesto de normalidad de los
errores</strong></span></h3>
<pre class="r"><code>e= modelo1$residuals

# Ho: los errores tienen distribución normal
shapiro.test(e)</code></pre>
<pre><code>
    Shapiro-Wilk normality test

data:  e
W = 0.96985, p-value = 0.8559</code></pre>
<p></br></br></p>
</div>
<div id="supuesto-de-independencia-de-errores" class="section level3">
<h3><span style="color:#034a94"><strong>Supuesto de independencia de
errores</strong></span></h3>
<pre class="r"><code>library(lmtest)
# Ho: los errores sin independientes ( no estan relacionados)
dwtest(modelo1)</code></pre>
<pre><code>
    Durbin-Watson test

data:  modelo1
DW = 1.6497, p-value = 0.2226
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
<p></br></br></p>
</div>
<div id="supuesto-de-varianza-constante" class="section level3">
<h3><span style="color:#034a94"><strong>Supuesto de varianza
constante</strong></span></h3>
<pre class="r"><code># Ho: la varianza de los erroes es constante
gqtest(modelo1)</code></pre>
<pre><code>
    Goldfeld-Quandt test

data:  modelo1
GQ = 0.76554, df1 = 6, df2 = 5, p-value = 0.6276
alternative hypothesis: variance increases from segment 1 to 2</code></pre>
<p></br></br></p>
</div>
<div id="supuesto-de-linealidad-del-modelo" class="section level3">
<h3><span style="color:#034a94"><strong>Supuesto de linealidad del
modelo</strong></span></h3>
<p></br></br></p>
</div>
<div id="representación-gráfica-del-modelo" class="section level3">
<h3><span style="color:#034a94"><strong>Representación gráfica del
modelo</strong></span></h3>
<pre class="r"><code>ggplot(ventas, aes(clientes, ventas)) +
            geom_point() + 
            geom_smooth(method = &quot;lm&quot;,  level = 0.95, formula = y ~ x)</code></pre>
<p><img src="recurso207_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p></br></br></p>
</div>
<div id="tranformaciones" class="section level3">
<h3><span style="color:#034a94"><strong>Tranformaciones</strong></h3>
<p>En caso de requerir transfomaciones a las variables del modelo
planteado con el fin demejorar sus indicadores y el cumplimiento loa
supuestos.</p>
<p></br></br></p>
<div id="modelo-log-lin" class="section level5">
<h5><span style="color:#034a94"><strong>Modelo
log-lin</strong></span></h5>
<pre class="r"><code>modelo2=lm(log(ventas) ~ clientes, ventas)
summary(modelo2)</code></pre>
<pre><code>
Call:
lm(formula = log(ventas) ~ clientes, data = ventas)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.29863 -0.07507  0.00534  0.09009  0.26277 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 3.224418   0.109256  29.512 2.68e-13 ***
clientes    0.005660   0.001045   5.414 0.000118 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.1673 on 13 degrees of freedom
Multiple R-squared:  0.6927,    Adjusted R-squared:  0.6691 
F-statistic: 29.31 on 1 and 13 DF,  p-value: 0.0001183</code></pre>
<p></br></br></p>
</div>
<div id="modelo-lin-log" class="section level5">
<h5><span style="color:#034a94"><strong>Modelo
lin-log</strong></span></h5>
<pre class="r"><code>modelo3=lm(ventas ~ log(clientes), ventas)
summary(modelo3)</code></pre>
<pre><code>
Call:
lm(formula = ventas ~ log(clientes), data = ventas)

Residuals:
    Min      1Q  Median      3Q     Max 
-14.333  -4.114   1.720   4.551  12.475 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    -50.075     19.635  -2.550 0.024178 *  
log(clientes)   21.307      4.376   4.869 0.000307 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 7.96 on 13 degrees of freedom
Multiple R-squared:  0.6458,    Adjusted R-squared:  0.6186 
F-statistic: 23.71 on 1 and 13 DF,  p-value: 0.0003066</code></pre>
<p></br></br></p>
</div>
<div id="modelo-log-log" class="section level5">
<h5><span style="color:#034a94"><strong>Modelo
log-log</strong></span></h5>
<pre class="r"><code>modelo4=lm(log(ventas) ~ log(clientes), ventas)
summary(modelo4)</code></pre>
<pre><code>
Call:
lm(formula = log(ventas) ~ log(clientes), data = ventas)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.35174 -0.06117  0.00826  0.10636  0.31173 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     1.6562     0.4552   3.638 0.003003 ** 
log(clientes)   0.4732     0.1015   4.664 0.000443 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.1845 on 13 degrees of freedom
Multiple R-squared:  0.626, Adjusted R-squared:  0.5972 
F-statistic: 21.76 on 1 and 13 DF,  p-value: 0.0004428</code></pre>
<p></br></br></p>
</div>
</div>
<div id="comparación-de-modelos" class="section level3">
<h3><span style="color:#034a94"><strong>Comparación de
modelos</strong></span></h3>
<pre class="r"><code>library(stargazer)
#stargazer(modelo1, modelo2, modelo3, modelo4,type=&quot;html&quot;, title=&quot;Comparación de modelos&quot;)
stargazer(modelo1, modelo2, modelo3, modelo4, type=&quot;text&quot;, df=FALSE)</code></pre>
<pre><code>
===============================================================
                                Dependent variable:            
                    -------------------------------------------
                     ventas   log(ventas)  ventas   log(ventas)
                       (1)        (2)        (3)        (4)    
---------------------------------------------------------------
clientes            0.261***   0.006***                        
                     (0.042)    (0.001)                        
                                                               
log(clientes)                             21.307***  0.473***  
                                           (4.376)    (0.101)  
                                                               
Constant            19.980***  3.224***   -50.075**  1.656***  
                     (4.390)    (0.109)   (19.635)    (0.455)  
                                                               
---------------------------------------------------------------
Observations           15         15         15         15     
R2                    0.748      0.693      0.646      0.626   
Adjusted R2           0.728      0.669      0.619      0.597   
Residual Std. Error   6.720      0.167      7.960      0.185   
F Statistic         38.503***  29.310***  23.706***  21.756*** 
===============================================================
Note:                               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
<p>Al comparar los valores de <span
class="math inline">\(R^{2}\)</span>, el <strong>modelo1</strong>
presenta el mayor porcentaje de explicación de la variabilidad de <span
class="math inline">\(Y\)</span></p>
<p></br></br></p>
</div>
<div id="indicador-aic" class="section level3">
<h3><span style="color:#034a94"><strong>Indicador
AIC</strong></span></h3>
<pre class="r"><code>AIC(modelo1, modelo2, modelo3, modelo4)</code></pre>
<pre><code>        df        AIC
modelo1  3 103.575586
modelo2  3  -7.223869
modelo3  3 108.656004
modelo4  3  -4.273938</code></pre>
<p></br></br></p>
</div>
<div id="predicción-de-eyx_o" class="section level3">
<h3><span style="color:#034a94"><strong>Predicción de <span
class="math inline">\(E[Y|x_{o}]\)</span></strong></span></h3>
<pre class="r"><code>predict(modelo1, data.frame(clientes=20), interval = &quot;confidence&quot;, level = 0.95)</code></pre>
<pre><code>      fit      lwr      upr
1 25.1925 17.34332 33.04168</code></pre>
<p></br></br></p>
</div>
<div id="predicción-de-y_0" class="section level3">
<h3><span style="color:#034a94"><strong>Predicción de <span
class="math inline">\(Y_{0}\)</span></strong></span></h3>
<pre class="r"><code>predict(modelo1, data.frame(clientes=20), interval = &quot;prediction&quot;, level = 0.95)</code></pre>
<pre><code>      fit      lwr      upr
1 25.1925 8.688234 41.69677</code></pre>
<p></br></br></p>
</div>
<div id="evaluación-de-la-linealidad-del-modelo" class="section level2">
<h2><span style="color:#034a94"><strong>Evaluación de la linealidad del
modelo</strong></span></h2>
<p></br></p>
<p>Para ello utilizamos la función <code>boxcox()</code> del paquete
<code>MASS</code></p>
<p></br></p>
<pre class="r"><code>library(paqueteMOD)
data(ventas) 
modelo1=lm(ventas ~ clientes, ventas)
summary(modelo1)</code></pre>
<pre><code>
Call:
lm(formula = ventas ~ clientes, data = ventas)

Residuals:
    Min      1Q  Median      3Q     Max 
-11.873  -2.861   0.255   3.511  10.595 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  19.9800     4.3897   4.552 0.000544 ***
clientes      0.2606     0.0420   6.205 3.19e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 6.72 on 13 degrees of freedom
Multiple R-squared:  0.7476,    Adjusted R-squared:  0.7282 
F-statistic:  38.5 on 1 and 13 DF,  p-value: 3.193e-05</code></pre>
<pre class="r"><code>par(mfrow = c(1,2))
boxcox(lm(ventas$ventas ~ ventas$clientes), lambda = -2:2)
#Se repite el proceso pero esta vez estrechando el rango de valores de lambda 
bc&lt;-boxcox(lm(ventas$ventas ~ ventas$clientes), lambda = 0:2)</code></pre>
<p><img src="recurso207_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="r"><code>(lambda &lt;- bc$x[which.max(bc$y)])</code></pre>
<pre><code>[1] 1.212121</code></pre>
<p></br></p>
<p>El valor de $= 1.212121 $ indica que la variable dependiente debe
continuar en la forma lineal <span
class="math inline">\(Y^{1}\)</span></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
